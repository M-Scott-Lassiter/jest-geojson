<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>core/featureCollections/featureCollection.js - Jest-GeoJSON</title>

        <meta
            name="description"
            content="An extended set of matcher functions for the Jest Javascript unit testing framework tailored to evaluating GeoJSON data."
        />

        <meta
            name="keywords"
            content="jest-geojson, jest, testing, validation, geojson, test, gis, assertions, matchers, jest-tests, jest-matchers, javascript, node, npm"
        />
        <meta
            name="keyword"
            content="jest-geojson, jest, testing, validation, geojson, test, gis, assertions, matchers, jest-tests, jest-matchers, javascript, node, npm"
        />

        <meta property="og:title" content="Jest-GeoJSON Documentation" />
        <meta property="og:type" content="article" />
        <meta
            property="og:image"
            content="https://github.com/M-Scott-Lassiter/jest-geojson/blob/main/images/banner.svg"
        />
        <meta property="og:site_name" content="Jest-GeoJSON" />
        <meta property="og:url" content="https://github.com/M-Scott-Lassiter/jest-geojson" />

        <script src="scripts/prettify/prettify.js"></script>
        <script src="scripts/prettify/lang-css.js"></script>
        <!--[if lt IE 9]>
            <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
        <link type="text/css" rel="stylesheet" href="styles/prettify.css" />
        <link type="text/css" rel="stylesheet" href="styles/jsdoc.css" />
        <script src="scripts/nav.js" defer></script>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    </head>
    <body>
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger" class="navicon-button x">
            <div class="navicon"></div>
        </label>

        <label for="nav-trigger" class="overlay"></label>

        <nav class="wrap">
            <input type="text" id="nav-search" placeholder="Search" />

            <h2><a href="index.html">Home</a></h2>
            <h2>
                <a
                    href="https://github.com/M-Scott-Lassiter/jest-geojson"
                    target="_blank"
                    class="menu-item"
                    id="repository"
                    >Github Repo</a
                >
            </h2>
            <h3>Namespaces</h3>
            <ul>
                <li><a href="Core.html">Core</a></li>
                <li>
                    <a href="Core.BoundingBoxes.html">Core.BoundingBoxes</a>
                    <ul class="methods">
                        <li data-type="method">
                            <a href="Core.BoundingBoxes.html#.valid2DBoundingBox"
                                >valid2DBoundingBox</a
                            >
                        </li>
                        <li data-type="method">
                            <a href="Core.BoundingBoxes.html#.valid3DBoundingBox"
                                >valid3DBoundingBox</a
                            >
                        </li>
                        <li data-type="method">
                            <a href="Core.BoundingBoxes.html#.validBoundingBox">validBoundingBox</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="Core.Coordinates.html">Core.Coordinates</a>
                    <ul class="methods">
                        <li data-type="method">
                            <a href="Core.Coordinates.html#.valid2DCoordinate">valid2DCoordinate</a>
                        </li>
                        <li data-type="method">
                            <a href="Core.Coordinates.html#.valid3DCoordinate">valid3DCoordinate</a>
                        </li>
                        <li data-type="method">
                            <a href="Core.Coordinates.html#.validCoordinate">validCoordinate</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="Core.FeatureCollections.html">Core.FeatureCollections</a>
                    <ul class="methods">
                        <li data-type="method">
                            <a href="Core.FeatureCollections.html#.featureCollection"
                                >featureCollection</a
                            >
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="Core.Features.html">Core.Features</a>
                    <ul class="methods">
                        <li data-type="method">
                            <a href="Core.Features.html#.feature">feature</a>
                        </li>
                        <li data-type="method"><a href="Core.Features.html#.hasID">hasID</a></li>
                    </ul>
                </li>
                <li>
                    <a href="Core.Geometries.html">Core.Geometries</a>
                    <ul class="methods">
                        <li data-type="method">
                            <a href="Core.Geometries.html#.anyGeometry">anyGeometry</a>
                        </li>
                        <li data-type="method">
                            <a href="Core.Geometries.html#.geometryCollection"
                                >geometryCollection</a
                            >
                        </li>
                        <li data-type="method">
                            <a href="Core.Geometries.html#.lineStringGeometry"
                                >lineStringGeometry</a
                            >
                        </li>
                        <li data-type="method">
                            <a href="Core.Geometries.html#.multiLineStringGeometry"
                                >multiLineStringGeometry</a
                            >
                        </li>
                        <li data-type="method">
                            <a href="Core.Geometries.html#.multiPointGeometry"
                                >multiPointGeometry</a
                            >
                        </li>
                        <li data-type="method">
                            <a href="Core.Geometries.html#.multiPolygonGeometry"
                                >multiPolygonGeometry</a
                            >
                        </li>
                        <li data-type="method">
                            <a href="Core.Geometries.html#.pointGeometry">pointGeometry</a>
                        </li>
                        <li data-type="method">
                            <a href="Core.Geometries.html#.polygonGeometry">polygonGeometry</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="Core.Utilities.html">Core.Utilities</a>
                    <ul class="methods">
                        <li data-type="method">
                            <a href="Core.Utilities.html#.commonGeometryValidation"
                                >commonGeometryValidation</a
                            >
                        </li>
                        <li data-type="method">
                            <a href="Core.Utilities.html#.validGeoJSON">validGeoJSON</a>
                        </li>
                    </ul>
                </li>
                <li><a href="Matchers.html">Matchers</a></li>
                <li>
                    <a href="Matchers.BoundingBoxes.html">Matchers.BoundingBoxes</a>
                    <ul class="methods">
                        <li data-type="method">
                            <a href="Matchers.BoundingBoxes.html#.isValid2DBoundingBox"
                                >isValid2DBoundingBox</a
                            >
                        </li>
                        <li data-type="method">
                            <a href="Matchers.BoundingBoxes.html#.isValid3DBoundingBox"
                                >isValid3DBoundingBox</a
                            >
                        </li>
                        <li data-type="method">
                            <a href="Matchers.BoundingBoxes.html#.isValidBoundingBox"
                                >isValidBoundingBox</a
                            >
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="Matchers.Coordinates.html">Matchers.Coordinates</a>
                    <ul class="methods">
                        <li data-type="method">
                            <a href="Matchers.Coordinates.html#.isValid2DCoordinate"
                                >isValid2DCoordinate</a
                            >
                        </li>
                        <li data-type="method">
                            <a href="Matchers.Coordinates.html#.isValid3DCoordinate"
                                >isValid3DCoordinate</a
                            >
                        </li>
                        <li data-type="method">
                            <a href="Matchers.Coordinates.html#.isValidCoordinate"
                                >isValidCoordinate</a
                            >
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="Matchers.FeatureCollections.html">Matchers.FeatureCollections</a>
                    <ul class="methods">
                        <li data-type="method">
                            <a href="Matchers.FeatureCollections.html#.toBeFeatureCollection"
                                >toBeFeatureCollection</a
                            >
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="Matchers.Features.html">Matchers.Features</a>
                    <ul class="methods">
                        <li data-type="method">
                            <a href="Matchers.Features.html#.toBeFeature">toBeFeature</a>
                        </li>
                        <li data-type="method">
                            <a href="Matchers.Features.html#.toHaveID">toHaveID</a>
                        </li>
                        <li data-type="method">
                            <a href="Matchers.Features.html#.toHaveNumericID">toHaveNumericID</a>
                        </li>
                        <li data-type="method">
                            <a href="Matchers.Features.html#.toHaveStringID">toHaveStringID</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="Matchers.Functional.html">Matchers.Functional</a>
                    <ul class="methods">
                        <li data-type="method">
                            <a href="Matchers.Functional.html#.toBeValidGeoJSON"
                                >toBeValidGeoJSON</a
                            >
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="Matchers.Geometries.html">Matchers.Geometries</a>
                    <ul class="methods">
                        <li data-type="method">
                            <a href="Matchers.Geometries.html#.toBeAnyGeometry">toBeAnyGeometry</a>
                        </li>
                        <li data-type="method">
                            <a href="Matchers.Geometries.html#.toBeGeometryCollection"
                                >toBeGeometryCollection</a
                            >
                        </li>
                        <li data-type="method">
                            <a href="Matchers.Geometries.html#.toBeLineStringGeometry"
                                >toBeLineStringGeometry</a
                            >
                        </li>
                        <li data-type="method">
                            <a href="Matchers.Geometries.html#.toBeMultiLineStringGeometry"
                                >toBeMultiLineStringGeometry</a
                            >
                        </li>
                        <li data-type="method">
                            <a href="Matchers.Geometries.html#.toBeMultiPointGeometry"
                                >toBeMultiPointGeometry</a
                            >
                        </li>
                        <li data-type="method">
                            <a href="Matchers.Geometries.html#.toBeMultiPolygonGeometry"
                                >toBeMultiPolygonGeometry</a
                            >
                        </li>
                        <li data-type="method">
                            <a href="Matchers.Geometries.html#.toBePointGeometry"
                                >toBePointGeometry</a
                            >
                        </li>
                        <li data-type="method">
                            <a href="Matchers.Geometries.html#.toBePolygonGeometry"
                                >toBePolygonGeometry</a
                            >
                        </li>
                    </ul>
                </li>
            </ul>
        </nav>

        <div id="main">
            <h1 class="page-title">core/featureCollections/featureCollection.js</h1>

            <section>
                <article>
                    <pre
                        class="prettyprint source linenums"
                    ><code>const { validBoundingBox } = require('../boundingBoxes/validBoundingBox')
const { feature } = require('../features/feature')

/**
 * Verifies an object is a valid GeoJSON FeatureCollection. This object requires a "type" member that must
 * equal 'FeatureCollection', and a "features" member that contains either a valid GeoJSON Feature
 * or an empty array.
 *
 * Foreign members are allowed with the exceptions thrown below.
 * If present, bounding boxes must be valid.
 *
 * @memberof Core.FeatureCollections
 * @see https://github.com/M-Scott-Lassiter/jest-geojson/issues/25
 * @param {object} featureCollectionObject a GeoJSON LineString Geometry object
 * @returns {boolean} True if a valid GeoJSON FeatureCollection. If invalid, it will throw an error.
 * @throws {Error} Argument not an object
 * @throws {Error} Must have a type property with value 'FeatureCollection'
 * @throws {Error} Forbidden from having a property 'coordinates', 'geometries', 'geometry', or 'properties'
 * @throws {Error} Bounding box must be valid (if present)
 * @example
 * const testFeatureCollection = {
 *     "type": "FeatureCollection",
 *     "features": [{
 *         "type": "Feature",
 *         "geometry": {
 *             "type": "Point",
 *             "coordinates": [102.0, 0.5]
 *         }
 *     },
 *     ...
 *     ]
 * }
 * const multiPoint = {
 *     type: "MultiPoint",
 *     coordinates: [
 *         [101.0, 0.0],
 *         [102.0, 1.0]
 *     ]
 * }
 *
 * const goodExample1 = featureCollection(testFeatureCollection)) // true
 *
 * const badExample1 = featureCollection(multiPoint)) // throws error
 * const badExample2 = featureCollection(testFeatureCollection.features)) // throws error
 */
function featureCollection(featureCollectionObject) {
    if (typeof featureCollectionObject !== 'object') {
        throw new Error(`Argument must be a FeatureCollection object.`)
    }

    if (featureCollectionObject.type !== 'FeatureCollection') {
        throw new Error(`Must have a type property with value 'FeatureCollection'.`)
    }

    if ('coordinates' in featureCollectionObject) {
        throw new Error(
            `GeoJSON FeatureCollection objects are forbidden from having a property 'coordinates'.`
        )
    }

    if ('geometries' in featureCollectionObject) {
        throw new Error(
            `GeoJSON FeatureCollection objects are forbidden from having a property 'geometries'.`
        )
    }

    if ('geometry' in featureCollectionObject) {
        throw new Error(
            `GeoJSON FeatureCollection objects are forbidden from having a property 'geometry'.`
        )
    }

    if ('properties' in featureCollectionObject) {
        throw new Error(
            `GeoJSON FeatureCollection objects are forbidden from having a property 'properties'.`
        )
    }

    if (!('features' in featureCollectionObject)) {
        throw new Error(`GeoJSON FeatureCollection objects must have a property 'features'.`)
    }

    if (!Array.isArray(featureCollectionObject.features)) {
        throw new Error(
            `GeoJSON FeatureCollection features must be either an array of valid Feature objects or an empty array.`
        )
    }

    // if (typeof featureCollectionObject.geometry !== 'object' || Array.isArray(featureCollectionObject.geometry)) {
    //     throw new Error(`GeoJSON Feature 'geometry' must be a valid GeoJSON geometry object.`)
    // }

    if ('bbox' in featureCollectionObject) {
        validBoundingBox(featureCollectionObject.bbox)
    }

    // if ('id' in featureCollectionObject) {
    //     if (
    //         !(typeof featureCollectionObject.id === 'number' || typeof featureCollectionObject.id === 'string') ||
    //         Number.isNaN(featureCollectionObject.id)
    //     ) {
    //         throw new Error(`If present, ID must be either a number or string.`)
    //     }
    // }

    // // Guard clause; features are allowed to have null geometry. However, if the matcher explicitly calls
    // // for a particular geometry type, null isn't an option. We have to check for that.
    // if (featureCollectionObject.geometry === null &amp;&amp; geometryType === undefined) {
    //     return true
    // }

    // // At this point, we have guaranteed there is a features array here. Validate each element with the core functions.
    featureCollectionObject.features.forEach((featureObject) => {
        feature(featureObject)
    })

    return true
}

exports.featureCollection = featureCollection
</code></pre>
                </article>
            </section>
        </div>

        <br class="clear" />

        <footer>
            Documentation generated by
            <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.10</a> using the
            <a href="https://github.com/clenemt/docdash">docdash</a> theme.
        </footer>

        <script>
            prettyPrint()
        </script>
        <script src="scripts/polyfill.js"></script>
        <script src="scripts/linenumber.js"></script>

        <script src="scripts/search.js" defer></script>
    </body>
</html>
